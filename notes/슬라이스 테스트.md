---
tags: [testing, slice-test, spring-boot, webmvctest, datajpatest]
---
# 슬라이스(slice) 테스트

- 스프링 자동 설정을 기능별로 잘라서 필요한 빈만 띄우는 테스트

```
Web 계층
 ├─ @WebMvcTest
 └─ @WebFluxTest

Data 계층
 ├─ @DataJpaTest
 ├─ @JdbcTest
 ├─ @DataMongoTest
 ├─ @DataRedisTest
 └─ 기타 Data*Test

Serialization
 └─ @JsonTest

외부 연동
 └─ @RestClientTest

메시징
 ├─ @KafkaTest (제한적)
 └─ @JmsTest
```

## WebMvcTest
**Controller 레이어만 실제 스프링 MVC 환경으로 띄워서**
- 대상 
	- @Controller, @RestController
	- @ControllerAdvice
	- Jackson, Validation, ArgumentResolver
- @Service, @Repository는 @MockBean으로 
- API 요청/응답, Bean Validation, Http status/header/body 계약


```kotlin
@WebMvcTest(OrderController.class)
class OrderControllerTest {

    @MockBean OrderService orderService;

    @Test
    void 주문_조회_API_응답_형식() {
        given(orderService.getOrder(1L))
            .willReturn(new OrderDto(1L));

        mockMvc.perform(get("/orders/1"))
            .andExpect(status().isOk())
            .andExpect(jsonPath("$.id").value(1));
    }
}
```

CASE 1 : 계약 테스트
목표 : 계약대로 수행되는가?
- 계약된 요청에 응답을 제대로 출력하는지
- status, body 확인

CASE 2 :  **Validation 테스트**
목표: 잘못된 요청에 적절한 에러 응답을 하는가?
- @Valid가 실제로 동작하는지  
- QueryParam/PathVariable 문제는 없는지 
- 메시지/필드명/에러코드 형태 체크

CASE 3 : @ControllerAdvice 동작 테스트
목표 : 예외에 따른 에러 계약이 잘 되어있는지 
- 특정 Exception에 status, error body 체크 

인터셉터 테스트 하려면?
@Import({WebMvcConfig.class, ClientVersionInterceptor.class}) 처럼 추가 해야함 


## Jpa

## Serialization

## Client


통합테스트 필요한 케이스 
- 필터 
- 

## 관련 노트
- [[테스트의 종류]]
- [[unit-test]]
- [[Junit]]
- [[단위 테스트에 대해 우리가 잘못 알고 있는 5가지 진실]]
- [[testing-conditions]]