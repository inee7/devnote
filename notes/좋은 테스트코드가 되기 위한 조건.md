---
tags: [testing, maintainability, refactoring-resistance]
---
# **좋은 테스트코드가 되기 위한 조건**
## **🧱 1️⃣ 리팩토링에 대한 저항성** (**Resistance to Refactoring**)
### **💡 의미**
- 코드 내부 구조가 바뀌어도(예: 함수 분리, 메서드명 변경, 리포지토리 교체)
    테스트가 **깨지지 않고 그대로 통과**하는 성질.
- 즉, **“내부 구현”이 아니라 “외부 동작(결과)”**을 검증하는 테스트.
- 이 개념은 [[단위 테스트에 대해 우리가 잘못 알고 있는 5가지 진실]]에서도 중요하게 다루어집니다.
### **🔍 예시**
- ❌ 나쁜 예:
```
verify(repo).save(any())    // 내부 호출 방식에 의존
```
- → 구현이 바뀌면 테스트 깨짐
- ✅ 좋은 예:
```
assertThat(result.id).isNotNull()    // 결과(효과) 중심 검증
```
### **💬 요약**
> “테스트는 코드 리팩토링의 발목을 잡으면 안 된다.”

## **🧰 2️⃣ 유지보수성**(**Maintainability**)
### **💡 의미**
- 테스트 코드를 **쉽게 읽고, 수정하고, 이해할 수 있는가**
- 테스트가 “문서처럼” 읽혀야 하며, **복잡한 설정과 중복**이 없어야 함.
### **🔍 예시**
- ❌ 나쁜 예:
    - JSON 문자열을 수십 줄 하드코딩
    - 테스트마다 복잡한 Mock 설정 반복            
- ✅ 좋은 예:
    - **Fixture 메서드**나 **Builder**를 통해 재사용
    - 테스트 이름이 시나리오처럼 자연스러움
```
@Test fun `만료된 프로모션은 조회되지 않는다`() { ... }
```
  ### **💬 요약**
> “테스트는 한 번 쓰고 버리는 게 아니라, **함께 진화해야 하는 코드**다.”

## **🛡️ 3️⃣ 회귀에 대한 보호**(**Protection against Regressions**)
### **💡 의미**
- 과거에 정상 작동하던 기능이 **나중에 망가졌을 때 이를 빠르게 잡아내는 능력**.
- 즉, **버그 방지망** 역할.
- 이게 테스트가 존재하는 **가장 본질적인 이유**이기도 함.
### **🔍 예시**
- 변경으로 인해 프로모션 만료 조건이 누락됐는데, 테스트가 실패함 → ✅ 좋은 테스트
- 반대로 테스트가 그걸 캐치하지 못하면,
    “그 테스트는 있으나 마나한 테스트”임.
### **💬 요약**
> “테스트는 코드가 바뀌어도, **버그가 다시 들어오는 걸 막는 방패**여야 한다.”
## **⚡ 4️⃣ 빠른 피드백**(**Fast Feedback**)
### **💡 의미**
- 테스트가 **자주, 빠르게 돌 수 있어야** 개발자에게 유용함.
- 너무 느린 테스트는 개발 흐름을 끊고, 결국 **아무도 실행하지 않게 됨.**
- 이 원칙은 [[좋은 단위테스트]]의 'FAST' 원칙과 일맥상통합니다.
### **🔍 예시**
- ❌ 나쁜 예:
    - 통합 테스트만 수백 개 (DB, 외부 API 전부 띄움)
    - 실행에 수분 걸림 → CI에서만 도는 “죽은 테스트”        
- ✅ 좋은 예:
    - 핵심 유스케이스는 빠른 단위 테스트로 커버
    - 느린 통합/엔드투엔드 테스트는 스케줄로 분리 (야간 빌드 등)    
### **💬 요약**
> “테스트가 느리면, **개발자가 테스트를 무시하기 시작한다.**”
## **⚖️ 우선순위 (실무 기준)**

| **우선순위** | **항목**        | **이유**                                 |
| -------- | ------------- | -------------------------------------- |
| 🥇 1     | **회귀에 대한 보호** | 테스트의 존재 이유 자체. 회귀를 막지 못하면 테스트의 가치가 없음. |
| 🥈 2     | **리팩토링 저항성**  | 버그를 잡더라도, 리팩토링 때마다 깨지면 유지비 폭발.         |
| 🥉 3     | **유지보수성**     | 읽히지 않고 수정 어려운 테스트는 결국 제거됨.             |
| 🏅 4     | **빠른 피드백**    | 속도는 중요하지만, 방패 역할보다 약간 후순위. CI로도 커버 가능. |
## **🎯 정리 문장**
> 좋은 테스트는
- > **버그를 다시 들어오지 못하게(회귀 방지)** 하면서
- > **구현 변경에 흔들리지 않고(리팩토링 저항성)**
- > **읽고 고치기 쉬우며(유지보수성)**
- > **빠르게 결과를 보여주는(피드백 속도)**
> 테스트다.
  
👉 **우선순위: 회귀 방지 > 리팩토링 저항성 > 유지보수성 > 빠른 피드백**

## 관련 노트
- [[테스트의 종류]]
- [[좋은 단위테스트]]
- [[단위 테스트에 대해 우리가 잘못 알고 있는 5가지 진실]]

#testcode #테스트코드
