---
tags: [design-pattern, kotlin, behavioral]
---

# 해석기 패턴

## 한 줄 요약

특정 도메인을 위한 언어(DSL)를 번역하고 실행할 수 있도록 하는 패턴

## 핵심 정리

- 특정한 언어를 번역할 때 사용하는 디자인 패턴
- DSL(Domain Specific Language) 특정 도메인에서 사용하기 위한 언어
- 가장 다루기 어려운 패턴 중 하나

## 상세 내용

### 구현 예제 - SQL DSL

```kotlin
fun main() {
    val sql = select("name, age") {
        from("users") {
            where("age > 25")
        } // Closes from
    } // Closes select

    println(sql) // "SELECT name, age FROM users WHERE age > 25"
}

fun select(columns: String, from: SelectClause.() -> Unit):
        SelectClause {
    return SelectClause(columns).apply(from)
}

class SelectClause(private val columns: String) {
    private lateinit var from: FromClause
    fun from(
        table: String,
        where: FromClause.() -> Unit
    ): FromClause {
        this.from = FromClause(table)
        return this.from.apply(where)
    }

    override fun toString() = "SELECT $columns $from"
}

class FromClause(private val table: String) {
    private lateinit var where: WhereClause

    fun where(conditions: String) = this.apply {
        where = WhereClause(conditions)
    }

    override fun toString() = "FROM $table $where"
}

class WhereClause(private val conditions: String) {
    override fun toString() = "WHERE $conditions"
}
```

### 특징

- 람다 수신자를 활용한 DSL 구성
- `apply`를 사용하여 빌더 패턴 구현
- 메서드 체이닝으로 자연스러운 문법 제공
- 타입 안전한 DSL 구현 가능

### 주의사항

가장 다루기 어려운 패턴 중 하나이다. 복잡한 문법을 구현하려면 신중한 설계가 필요하다.

---

**출처**
- 코틀린 디자인 패턴
