---
tags: [design-pattern, kotlin, behavioral]
---

# 명령 패턴

## 한 줄 요약

동작을 객체 내부에 캡슐화하여 나중에 실행할 수 있도록 하는 패턴

## 핵심 정리

- 객체 내부에 동작을 캡슐화해서 넣어둔 뒤 나중에 실행되도록 함
- 동작 실행을 지연시키면 한꺼번에 많은 동작을 실행할 수도 있고, 실행 타이밍을 세밀하게 조절도 가능
- 명령을 큐에 넣고 순차적으로 실행하는 방식으로 구현 가능

## 상세 내용

### 구현 예제

```kotlin
typealias Command = () -> Unit

open class Trooper {
    private val orders = mutableListOf<Command>()

    fun addOrder(order: Command) {
        this.orders.add(order)
    }

    fun appendMove(x: Int, y: Int) = apply {
        orders.add(moveGenerator(this, x, y))
    }

    fun execute() {
        while (orders.isNotEmpty()) {
            val order = orders.removeFirst()
            order()
        }
    }

    fun move(x: Int, y: Int) {
        println("Moving to $x:$y")
    }
}

val moveGenerator = fun(
    s: Trooper,
    x: Int,
    y: Int,
): Command {
    return fun() {
        s.move(x, y)
    }
}

fun main() {
    val t = Trooper()
    t.appendMove(1, 1).appendMove(2, 2).appendMove(3, 3).execute()
}
```

### 활용 방식

- 명령을 큐에 저장하고 순차적으로 실행
- Fluent API 방식으로 체이닝 가능
- 실행 타이밍을 완전히 제어 가능

---

**출처**
- 코틀린 디자인 패턴
