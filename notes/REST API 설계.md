---
tags: [restful, rest-api, api-design, microservice, http]
---

## 한 줄 요약

성공적인 REST API는 리소스를 명사(복수형)로, 행위를 동사(HTTP Method)로 표현하는 일관된 URI 규칙을 따르고, 무상태성과 멱등성의 원칙을 지켜 설계해야 한다.

## REST API의 3가지 구성 요소

- **리소스 (Resource)**: HTTP URI로 표현 (예: `/users`)
- **행위 (Verb)**: HTTP Method로 표현 (예: `GET`, `POST`, `PUT`, `DELETE`)
- **표현 (Representation)**: `JSON` 형식을 주로 사용

## URI 설계 원칙

- **명사 사용, 복수형 권장**: 리소스 이름은 동사가 아닌 명사를 사용한다. (메소드가 동사 역할을 하므로)
  - `GET /users` (O)
  - `GET /getAllUsers` (X)
- **계층 관계 표현**: `GET /users/123/posts` 와 같이 리소스 간의 관계를 나타낼 수 있다.
- **고유 식별자**: URI에 포함되는 식별자는 고유하고 일관성 있는 DB의 기본 키(Primary Key)를 사용하는 것이 좋다.
- **페이징 및 정렬**: `GET` 요청 시, 페이징 정보(e.g., `page`, `size`)와 정렬 정보(e.g., `sort`)는 쿼리 파라미터로 처리한다.
  - `GET /users?page=1&size=10&sort=createdAt,desc`
- **API 버전 관리**: 변경에 유연하게 대응하기 위해 API 버전을 명시하는 것이 좋다.
  - URI에 포함: `GET /v1/users`
  - 헤더에 포함: `Accept: application/vnd.company.v1+json`

## HTTP 응답 설계

- **에러 응답**: 400 (Bad Request) 같은 클라이언트 오류 발생 시, 응답 본문에 어떤 필드가 왜 잘못되었는지 구체적인 정보를 담아주면 디버깅에 용이하다.

## REST API의 주요 특성

### 무상태성 (Statelessness)
- HTTP 프로토콜의 무상태성을 그대로 계승한다.
- 서버는 클라이언트의 상태를 저장하지 않으므로, 요청마다 필요한 모든 정보를 포함해야 한다.
- **장점**: 상태에 대한 의존성이 없어 서버를 쉽게 증설/축소할 수 있어 확장성(Scalability)과 고가용성에 유리하며, 배포가 간편하다.

### 일관성 (Consistency)
- API 스펙의 일관성이 있으면 사용자가 API를 예측하고 이해하기 쉽다.
- 마이크로서비스 아키텍처에서 여러 서비스가 각기 다른 포맷을 제공하면, 이를 사용하는 클라이언트의 개발 복잡도가 크게 증가한다.

### 멱등성 (Idempotency)
- **정의**: 동일한 요청을 여러 번 보내도 단 한 번 보낸 것과 같은 결과를 보장하는 특성.
- **`GET`, `PUT`, `DELETE`**: 멱등성을 가져야 한다.
  - `GET`: 리소스 상태를 변경하지 않으므로 안전(Safe)하면서 멱등하다.
  - `PUT`: 리소스 전체를 교체하므로 여러 번 수행해도 결과는 동일하다.
  - `DELETE`: 리소스를 삭제하므로 여러 번 수행해도 결과는 동일하다.
- **`POST`**: 리소스를 생성하므로 호출할 때마다 새로운 리소스가 만들어질 수 있어 멱등하지 않다.

#### 멱등성 설계 예시

- **`PUT`**:
  - **잘못된 설계**: `PUT /hotels/912/open` 요청 시, 서버가 현재 상태의 NOT으로 상태를 변경 (`isOpened = !isOpened`). 동시에 두 번 호출하면 상태가 원래대로 돌아온다.
  - **올바른 설계**: `PUT /hotels/912` 요청의 본문에 `{ "isOpened": true }` 와 같이 변경될 값을 명시적으로 받아 그대로 반영한다.
- **`DELETE`**:
  - **잘못된 설계**: `DELETE /posts/99` 요청 시, DB에서 데이터를 확인 후 없으면 `404 NOT_FOUND`를 반환. 네트워크 유실로 첫 응답을 못 받고 재요청하면 404를 받아 클라이언트가 혼란에 빠질 수 있다.
  - **올바른 설계**: 해당 데이터가 없더라도, 삭제 작업의 최종 목표는 '데이터가 없는 상태'이므로 성공(`200 OK` 또는 `204 No Content`)으로 응답한다.
